<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" type="image/svg+xml" href="Logo.svg">
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QLD Radio Player</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
    body {
        margin: 0;
        font-family: 'Poppins', sans-serif;
        background: linear-gradient(135deg, #270c0c, #1a1a1a);
        background-size: 300% 300%;
        animation: bgMove 8s infinite alternate;
        color: #fff;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        text-align: center;
    }
    @keyframes bgMove {
        0% { background-position: 0% 50%; }
        100% { background-position: 100% 50%; }
    }
    h1 { font-size: 2.5rem; margin-bottom: 20px; }
    .station-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 20px;
        max-width: 1100px;
    }
    disclamer {
        padding-top: 50px;
    }
    .station-card {
        background: rgba(255, 255, 255, 0.08);
        border-radius: 15px;
        padding: 20px;
        width: 260px;
        position: relative;
        transition: transform 0.3s, background 0.3s, box-shadow 0.3s;
        text-align: center;
        box-shadow: 0 0 10px rgba(255, 0, 0, 0.2);
    }
    .station-card:hover {
        transform: scale(1.05);
        background: rgba(255,255,255,0.15);
        box-shadow: 0 0 25px rgba(255, 51, 51, 0.6);
    }
    .station-logo {
        width: 80px; height: 80px;
        border-radius: 50%;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 0 auto 10px;
        background: #222;
    }
    .station-logo img {
        width: 100%;
        height: 100%;
        background-color: #fff;
        object-fit: cover;
    }
    .station-name { font-size: 1.2rem; font-weight: 600; margin-bottom: 10px; }
    .live-indicator {
        display: none;
        position: absolute; top: 10px; right: 10px;
        background: red; border-radius: 50%; width: 12px; height: 12px;
        box-shadow: 0 0 10px red;
        animation: pulse 1.5s infinite;
    }
    @keyframes pulse {
        0% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.5); opacity: 1; }
        100% { transform: scale(1); opacity: 1; }
    }
    .controls {
        display: flex; justify-content: center; align-items: center; gap: 10px;
        margin-top: 10px;
    }
    .play-btn {
        width: 50px; height: 50px;
        background: #ff3333; border: none; color: white;
        border-radius: 50%; cursor: pointer;
        display: flex; align-items: center; justify-content: center;
        transition: box-shadow 0.3s, transform 0.2s;
        font-size: 1.4rem;
    }
    .play-btn:hover {
        box-shadow: 0 0 20px #ff3333;
        transform: scale(1.1);
    }
    .progress-bar {
        flex: 1; height: 8px; background: rgba(255,255,255,0.3);
        border-radius: 4px; overflow: hidden;
    }
    .progress-fill {
        width: 100%; height: 100%; background: #ff3333;
        animation: liveAnimation 2s infinite linear;
    }
    @keyframes liveAnimation {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
    }
    .equalizer {
        display: none;
        position: absolute;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 3px;
    }
    .bar {
        width: 4px;
        background: #ff3333;
        animation: bounce 1s infinite;
    }
    .bar:nth-child(1) { height: 10px; animation-delay: 0s; }
    .bar:nth-child(2) { height: 15px; animation-delay: 0.1s; }
    .bar:nth-child(3) { height: 8px; animation-delay: 0.2s; }
    .bar:nth-child(4) { height: 12px; animation-delay: 0.3s; }
    @keyframes bounce {
        0%, 100% { transform: scaleY(1); }
        50% { transform: scaleY(2); }
    }
    audio { display: none; }
    .icon { width: 20px; height: 20px; fill: #fff; }
</style>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
</head>
<body>
<h1>Queensland Live Radio Station Player</h1>
<p class="disclamer">Loading stations may be slow due to network traffic.</p>
<div class="station-container"></div>

<script>
const stations = [
    { id: "coles", name: "Coles Radio QLD", url: "https://playerservices.streamtheworld.com/api/livestream-redirect/COLES_CONSUMER_QLD.mp3", logo: "https://www.radioapp.com.au/wp-content/uploads/2018/12/Website-coles_450x450.png" },
    { id: "kiis", name: "KIIS 97.3 FM QLD", url: "http://playerservices.streamtheworld.com/api/livestream-redirect/ARN_973FMAAC.aac", logo: "https://i.iheart.com/v3/re/new_assets/63897b44310464f53fecf546" },
    { id: "river", name: "River 94.9 FM QLD", url: "http://playerservices.streamtheworld.com/api/livestream-redirect/IPS_RIVER949AAC.m3u8", logo: "https://www.radioapp.com.au/wp-content/uploads/2018/12/River-949-Ipswich.png" },
    { id: "triplej", name: "Triple J 107.7 FM", url: "http://streaming.c3.abc.net.au/hottest100_b_aac", logo: "https://triplejstore.com.au/cdn/shop/collections/5_496a60d6-3789-41e4-9608-7a46d9a5e8fd.webp?v=1736118610&width=1500" },
    { id: "logan101", name: "Logan City 101.0 FM", url: "https://28893.live.streamtheworld.com/4CBL.mp3", logo: "https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcStMO70L3IGdMfqw46R3qZ-VJdpKdumkOtddd_NnjGfC9bYS3eVHX757n_h70f7h-W1Y0clD0yvsssWbTOJqlxVYCIJNI9_hYDccb0qg_w" }
];

const container = document.querySelector('.station-container');
stations.forEach(station => {
    container.innerHTML += `
    <div class="station-card">
        <div class="station-logo"><img src="${station.logo}" alt="${station.name}"></div>
        <div class="station-name">${station.name}</div>
        <div class="live-indicator" id="live-${station.id}"></div>
        <div class="controls">
            <button class="play-btn" onclick="toggleStation('${station.id}')">
                <svg class="icon" id="icon-${station.id}" viewBox="0 0 24 24">
                    <polygon points="5,3 19,12 5,21" />
                </svg>
            </button>
            <div class="progress-bar"><div class="progress-fill"></div></div>
        </div>
        <div class="equalizer" id="eq-${station.id}">
            <div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="bar"></div>
        </div>
        <audio id="${station.id}" preload="none"></audio>
    </div>`;
});

const audios = {}, indicators = {}, icons = {}, equalizers = {};
stations.forEach(st => {
    audios[st.id] = document.getElementById(st.id);
    indicators[st.id] = document.getElementById('live-' + st.id);
    icons[st.id] = document.getElementById('icon-' + st.id);
    equalizers[st.id] = document.getElementById('eq-' + st.id);
});

let hls;
if (Hls.isSupported()) {
    hls = new Hls({ liveSyncDurationCount: 3 });
    hls.loadSource(stations.find(s => s.id === 'river').url);
    hls.attachMedia(audios['river']);
} else if (audios['river'].canPlayType('application/vnd.apple.mpegurl')) {
    audios['river'].src = stations.find(s => s.id === 'river').url;
}

stations.forEach(st => { if (st.id !== 'river') audios[st.id].src = st.url; });

// Fade-in audio function
function fadeInAudio(audio) {
    audio.volume = 0;
    const step = 0.05; // volume increment
    const interval = setInterval(() => {
        if (audio.volume < 1) {
            audio.volume = Math.min(audio.volume + step, 1);
        } else {
            clearInterval(interval);
        }
    }, 100);
}

function toggleStation(id) {
    const selected = audios[id];
    const isPlaying = !selected.paused && !selected.ended;

    Object.values(audios).forEach(a => a.pause());
    Object.values(indicators).forEach(ind => ind.style.display = 'none');
    Object.values(equalizers).forEach(eq => eq.style.display = 'none');
    Object.values(icons).forEach(icon => icon.innerHTML = '<polygon points="5,3 19,12 5,21" />');

    if (!isPlaying) {
        if (id === 'river' && hls) {
            hls.stopLoad();
            hls.startLoad();
            hls.startPosition = -1;
        } else {
            selected.load();
        }
        selected.play();
        fadeInAudio(selected);
        indicators[id].style.display = 'block';
        equalizers[id].style.display = 'flex';
        icons[id].innerHTML = '<rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/>';
    }
}

if ('serviceWorker' in navigator) navigator.serviceWorker.register('service-worker.js');
</script>
</body>
</html>
